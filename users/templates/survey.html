{% extends "base.html" %}

{% block title %}Health Assessment - Patient Health Portal{% endblock %}

{% block content %}
<div class="main-container">
    <div class="text-center mb-4">
        <h2><i class="fas fa-clipboard-list me-2"></i>Health Assessment</h2>
        <p class="text-muted">Please answer these questions to help us understand your health goals and current status</p>
    </div>

    <div class="step-indicator">
        <div class="step active">1</div>
        <div class="step">2</div>
        <div class="step">3</div>
        <div class="step">4</div>
        <div class="step">5</div>
        <div class="step">6</div>
        <div class="step">7</div>
    </div>

    <form method="POST" id="surveyForm">
        <div class="card">
            <div class="card-body p-4">
                <!-- Question 1 -->
                <div class="question-section mb-4">
                    <h5 class="mb-3">
                        <span class="badge bg-primary me-2">1</span>
                        What is your primary health goal or area of interest right now?
                    </h5>
                    <p class="text-muted mb-3">Select all that apply</p>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Recovering from an illness or injury" id="q1_1">
                                <label class="form-check-label" for="q1_1">
                                    Recovering from an illness or injury
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Improving my mental well-being (e.g., stress, anxiety, depression)" id="q1_2">
                                <label class="form-check-label" for="q1_2">
                                    Improving my mental well-being (e.g., stress, anxiety, depression)
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Health and performance" id="q1_3">
                                <label class="form-check-label" for="q1_3">
                                    Health and performance
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Preventing future health issues and biohacking" id="q1_4">
                                <label class="form-check-label" for="q1_4">
                                    Preventing future health issues and biohacking
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Supporting maternal or child health" id="q1_5">
                                <label class="form-check-label" for="q1_5">
                                    Supporting maternal or child health
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Addressing age-related health concerns (for seniors)" id="q1_6">
                                <label class="form-check-label" for="q1_6">
                                    Addressing age-related health concerns (for seniors)
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Improving my sleep" id="q1_7">
                                <label class="form-check-label" for="q1_7">
                                    Improving my sleep
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Managing skin conditions or improving skin health" id="q1_8">
                                <label class="form-check-label" for="q1_8">
                                    Managing skin conditions or improving skin health
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Seeking sexual and reproductive health support" id="q1_9">
                                <label class="form-check-label" for="q1_9">
                                    Seeking sexual and reproductive health support
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Finding support for recovery from substance use" id="q1_10">
                                <label class="form-check-label" for="q1_10">
                                    Finding support for recovery from substance use
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="question_1" value="Preparing for travel health needs" id="q1_11">
                                <label class="form-check-label" for="q1_11">
                                    Preparing for travel health needs
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question 2 -->
                <div class="question-section mb-4">
                    <h5 class="mb-3">
                        <span class="badge bg-primary me-2">2</span>
                        How would you describe your current physical activity level?
                    </h5>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_2" value="Sedentary (little to no exercise)" id="q2_1" required>
                        <label class="form-check-label" for="q2_1">
                            Sedentary (little to no exercise)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_2" value="Lightly active (occasional walks, light chores)" id="q2_2">
                        <label class="form-check-label" for="q2_2">
                            Lightly active (occasional walks, light chores)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_2" value="Moderately active (regular exercise 3-5 times/week)" id="q2_3">
                        <label class="form-check-label" for="q2_3">
                            Moderately active (regular exercise 3-5 times/week)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_2" value="Very active (intense exercise 5-7 times/week, competitive sports)" id="q2_4">
                        <label class="form-check-label" for="q2_4">
                            Very active (intense exercise 5-7 times/week, competitive sports)
                        </label>
                    </div>
                </div>

                <!-- Question 3 -->
                <div class="question-section mb-4">
                    <h5 class="mb-3">
                        <span class="badge bg-primary me-2">3</span>
                        How would you rate your sleep quality on most nights?
                    </h5>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_3" value="Excellent (consistently restful, wake up refreshed)" id="q3_1" required>
                        <label class="form-check-label" for="q3_1">
                            Excellent (consistently restful, wake up refreshed)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_3" value="Good (generally restful, occasional minor issues)" id="q3_2">
                        <label class="form-check-label" for="q3_2">
                            Good (generally restful, occasional minor issues)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_3" value="Fair (some difficulty falling/staying asleep, often feel tired)" id="q3_3">
                        <label class="form-check-label" for="q3_3">
                            Fair (some difficulty falling/staying asleep, often feel tired)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_3" value="Poor (frequent sleep problems, rarely feel rested)" id="q3_4">
                        <label class="form-check-label" for="q3_4">
                            Poor (frequent sleep problems, rarely feel rested)
                        </label>
                    </div>
                </div>

                <!-- Question 4 -->
                <div class="question-section mb-4">
                    <h5 class="mb-3">
                        <span class="badge bg-primary me-2">4</span>
                        How would you describe your current mental well-being?
                    </h5>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_4" value="Very good (feeling positive, resilient, low stress)" id="q4_1" required>
                        <label class="form-check-label" for="q4_1">
                            Very good (feeling positive, resilient, low stress)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_4" value="Good (mostly positive, manage stress well)" id="q4_2">
                        <label class="form-check-label" for="q4_2">
                            Good (mostly positive, manage stress well)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_4" value="Okay (some ups and downs, occasional stress/anxiety)" id="q4_3">
                        <label class="form-check-label" for="q4_3">
                            Okay (some ups and downs, occasional stress/anxiety)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_4" value="Struggling (frequent stress, anxiety, or low mood)" id="q4_4">
                        <label class="form-check-label" for="q4_4">
                            Struggling (frequent stress, anxiety, or low mood)
                        </label>
                    </div>
                </div>

                <!-- Question 5 -->
                <div class="question-section mb-4">
                    <h5 class="mb-3">
                        <span class="badge bg-primary me-2">5</span>
                        Which of the following best describes your dietary habits?
                    </h5>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_5" value="Balanced and healthy (regular meals, variety of foods)" id="q5_1" required>
                        <label class="form-check-label" for="q5_1">
                            Balanced and healthy (regular meals, variety of foods)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_5" value="Trying to eat healthier (making conscious efforts)" id="q5_2">
                        <label class="form-check-label" for="q5_2">
                            Trying to eat healthier (making conscious efforts)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_5" value="Specific diet (e.g., Vegetarian, Vegan, Keto, Gluten-Free)" id="q5_3">
                        <label class="form-check-label" for="q5_3">
                            Specific diet (e.g., Vegetarian, Vegan, Keto, Gluten-Free)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_5" value="Irregular or inconsistent (often skip meals, unhealthy choices)" id="q5_4">
                        <label class="form-check-label" for="q5_4">
                            Irregular or inconsistent (often skip meals, unhealthy choices)
                        </label>
                    </div>
                </div>

                <!-- Question 6 -->
                <div class="question-section mb-4">
                    <h5 class="mb-3">
                        <span class="badge bg-primary me-2">6</span>
                        How often do you seek professional medical health (e.g., doctor's visits, specialist consultations)?
                    </h5>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_6" value="Rarely or never" id="q6_1" required>
                        <label class="form-check-label" for="q6_1">
                            Rarely or never
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_6" value="Once a year for a check-up" id="q6_2">
                        <label class="form-check-label" for="q6_2">
                            Once a year for a check-up
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_6" value="A few times a year for specific issues" id="q6_3">
                        <label class="form-check-label" for="q6_3">
                            A few times a year for specific issues
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_6" value="Frequently (multiple times a year or ongoing care)" id="q6_4">
                        <label class="form-check-label" for="q6_4">
                            Frequently (multiple times a year or ongoing care)
                        </label>
                    </div>
                </div>

                <!-- Question 7 -->
                <div class="question-section mb-4">
                    <h5 class="mb-3">
                        <span class="badge bg-primary me-2">7</span>
                        Do you plan to travel internationally in the next 12 months?
                    </h5>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_7" value="Yes, frequently (multiple trips)" id="q7_1" required>
                        <label class="form-check-label" for="q7_1">
                            Yes, frequently (multiple trips)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_7" value="Yes, occasionally (1-2 trips)" id="q7_2">
                        <label class="form-check-label" for="q7_2">
                            Yes, occasionally (1-2 trips)
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_7" value="No, but I might in the future" id="q7_3">
                        <label class="form-check-label" for="q7_3">
                            No, but I might in the future
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="question_7" value="No, not planning to travel internationally" id="q7_4">
                        <label class="form-check-label" for="q7_4">
                            No, not planning to travel internationally
                        </label>
                    </div>
                </div>

                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-arrow-right me-2"></i>Complete Assessment
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>

<script>
// Form validation
document.getElementById('surveyForm').addEventListener('submit', function(e) {
    const question1Checkboxes = document.querySelectorAll('input[name="question_1"]:checked');
    const question2Radio = document.querySelector('input[name="question_2"]:checked');
    const question3Radio = document.querySelector('input[name="question_3"]:checked');
    const question4Radio = document.querySelector('input[name="question_4"]:checked');
    const question5Radio = document.querySelector('input[name="question_5"]:checked');
    const question6Radio = document.querySelector('input[name="question_6"]:checked');
    const question7Radio = document.querySelector('input[name="question_7"]:checked');
    
    if (question1Checkboxes.length === 0) {
        e.preventDefault();
        alert('Please select at least one health goal for question 1.');
        return;
    }
    
    if (!question2Radio || !question3Radio || !question4Radio || !question5Radio || !question6Radio || !question7Radio) {
        e.preventDefault();
        alert('Please answer all questions before submitting.');
        return;
    }
});

// Progress tracking
function updateProgress() {
    const questions = [
        document.querySelectorAll('input[name="question_1"]:checked').length > 0,
        document.querySelector('input[name="question_2"]:checked') !== null,
        document.querySelector('input[name="question_3"]:checked') !== null,
        document.querySelector('input[name="question_4"]:checked') !== null,
        document.querySelector('input[name="question_5"]:checked') !== null,
        document.querySelector('input[name="question_6"]:checked') !== null,
        document.querySelector('input[name="question_7"]:checked') !== null
    ];
    
    const steps = document.querySelectorAll('.step');
    questions.forEach((answered, index) => {
        if (answered) {
            steps[index].classList.add('completed');
            steps[index].classList.remove('active');
        } else {
            steps[index].classList.remove('completed');
            if (index === 0 || (index > 0 && questions[index - 1])) {
                steps[index].classList.add('active');
            }
        }
    });
}

// Add event listeners for progress tracking
document.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(input => {
    input.addEventListener('change', updateProgress);
});

// Initialize progress
updateProgress();
</script>
{% endblock %} 